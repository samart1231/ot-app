<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>รายรับรายจ่าย</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Mobile-first design */
        @media (max-width: 768px) {
            .mobile-container {
                padding: 8px;
                margin-top: 60px;
            }
            
            .mobile-card {
                background: white;
                border-radius: 16px;
                padding: 16px;
                margin-bottom: 16px;
                box-shadow: 0 4px 12px rgba(0,0,0,0.1);
                border: 1px solid #e5e7eb;
            }
            
            .mobile-form-field {
                margin-bottom: 16px;
            }
            
            .mobile-label {
                display: flex;
                align-items: center;
                gap: 8px;
                font-size: 14px;
                font-weight: 600;
                color: #374151;
                margin-bottom: 8px;
            }
            
            .mobile-input {
                width: 100%;
                padding: 12px 16px;
                border: 2px solid #e5e7eb;
                border-radius: 12px;
                font-size: 16px;
                background: white;
                transition: all 0.2s ease;
                min-height: 48px;
            }
            
            .mobile-input:focus {
                outline: none;
                border-color: #3b82f6;
                box-shadow: 0 0 0 4px rgba(59, 130, 246, 0.1);
            }
            
            .mobile-select {
                width: 100%;
                padding: 12px 16px;
                border: 2px solid #e5e7eb;
                border-radius: 12px;
                font-size: 16px;
                background: white;
                min-height: 48px;
                appearance: none;
                background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 20 20'%3e%3cpath stroke='%236b7280' stroke-linecap='round' stroke-linejoin='round' stroke-width='1.5' d='M6 8l4 4 4-4'/%3e%3c/svg%3e");
                background-position: right 12px center;
                background-repeat: no-repeat;
                background-size: 16px;
                padding-right: 40px;
            }
            
            .mobile-button {
                width: 100%;
                padding: 16px;
                border: none;
                border-radius: 12px;
                font-size: 16px;
                font-weight: 600;
                cursor: pointer;
                transition: all 0.2s ease;
                min-height: 48px;
                display: flex;
                align-items: center;
                justify-content: center;
                gap: 8px;
            }
            
            .mobile-button-primary {
                background: linear-gradient(135deg, #3b82f6 0%, #1d4ed8 100%);
                color: white;
                box-shadow: 0 4px 12px rgba(59, 130, 246, 0.3);
            }
            
            .mobile-button-primary:hover {
                transform: translateY(-2px);
                box-shadow: 0 6px 16px rgba(59, 130, 246, 0.4);
            }
            
            .mobile-button-secondary {
                background: #f3f4f6;
                color: #374151;
                border: 2px solid #e5e7eb;
            }
            
            .mobile-button-success {
                background: linear-gradient(135deg, #10b981 0%, #059669 100%);
                color: white;
                box-shadow: 0 4px 12px rgba(16, 185, 129, 0.3);
            }
            
            .mobile-button-danger {
                background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);
                color: white;
                box-shadow: 0 4px 12px rgba(239, 68, 68, 0.3);
            }
            
            .mobile-item-card {
                background: #f8fafc;
                border: 2px solid #e2e8f0;
                border-radius: 12px;
                padding: 16px;
                margin-bottom: 12px;
            }
            
            .mobile-item-header {
                display: flex;
                justify-content: between;
                align-items: center;
                margin-bottom: 12px;
            }
            
            .mobile-item-number {
                width: 32px;
                height: 32px;
                background: linear-gradient(135deg, #3b82f6 0%, #1d4ed8 100%);
                color: white;
                border-radius: 50%;
                display: flex;
                align-items: center;
                justify-content: center;
                font-size: 14px;
                font-weight: bold;
                margin-right: 12px;
            }
            
            .mobile-emoji-picker {
                display: grid;
                grid-template-columns: repeat(8, 1fr);
                gap: 8px;
                max-height: 200px;
                overflow-y: auto;
                padding: 8px;
                background: #f9fafb;
                border-radius: 8px;
                margin-top: 8px;
            }
            
            .mobile-emoji-btn {
                width: 40px;
                height: 40px;
                border: none;
                background: white;
                border-radius: 8px;
                font-size: 20px;
                cursor: pointer;
                transition: all 0.2s ease;
                box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            }
            
            .mobile-emoji-btn:hover {
                transform: scale(1.1);
                box-shadow: 0 4px 8px rgba(0,0,0,0.15);
            }
            
            .mobile-summary-grid {
                display: grid;
                grid-template-columns: 1fr 1fr;
                gap: 12px;
                margin-bottom: 20px;
            }
            
            .mobile-summary-card {
                background: white;
                padding: 16px;
                border-radius: 12px;
                text-align: center;
                box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            }
            
            .mobile-summary-icon {
                font-size: 24px;
                margin-bottom: 8px;
            }
            
            .mobile-summary-amount {
                font-size: 18px;
                font-weight: bold;
                margin-bottom: 4px;
            }
            
            .mobile-summary-label {
                font-size: 12px;
                color: #6b7280;
            }
            
            .mobile-record-card {
                background: white;
                border-radius: 12px;
                padding: 16px;
                margin-bottom: 12px;
                box-shadow: 0 2px 8px rgba(0,0,0,0.1);
                border-left: 4px solid transparent;
            }
            
            .mobile-record-card.income {
                border-left-color: #10b981;
            }
            
            .mobile-record-card.expense {
                border-left-color: #ef4444;
            }
            
            .mobile-record-header {
                display: flex;
                justify-content: space-between;
                align-items: flex-start;
                margin-bottom: 12px;
            }
            
            .mobile-record-date {
                font-size: 12px;
                color: #6b7280;
                background: #f3f4f6;
                padding: 4px 8px;
                border-radius: 6px;
            }
            
            .mobile-record-amount {
                font-size: 18px;
                font-weight: bold;
            }
            
            .mobile-record-amount.income {
                color: #10b981;
            }
            
            .mobile-record-amount.expense {
                color: #ef4444;
            }
            
            .mobile-record-description {
                font-size: 16px;
                font-weight: 600;
                color: #111827;
                margin-bottom: 8px;
            }
            
            .mobile-record-meta {
                display: grid;
                grid-template-columns: 1fr 1fr;
                gap: 8px;
                margin-bottom: 12px;
            }
            
            .mobile-record-meta-item {
                font-size: 12px;
                color: #6b7280;
                background: #f9fafb;
                padding: 6px 8px;
                border-radius: 6px;
            }
            
            .mobile-record-actions {
                display: flex;
                gap: 8px;
            }
            
            .mobile-record-btn {
                flex: 1;
                padding: 8px 12px;
                border: none;
                border-radius: 8px;
                font-size: 12px;
                font-weight: 600;
                cursor: pointer;
                transition: all 0.2s ease;
            }
            
            .mobile-record-btn-edit {
                background: #3b82f6;
                color: white;
            }
            
            .mobile-record-btn-delete {
                background: #ef4444;
                color: white;
            }
            
            .mobile-floating-menu {
                position: fixed;
                bottom: 20px;
                right: 20px;
                z-index: 1000;
            }
            
            .mobile-fab {
                width: 56px;
                height: 56px;
                background: linear-gradient(135deg, #3b82f6 0%, #1d4ed8 100%);
                color: white;
                border: none;
                border-radius: 50%;
                font-size: 24px;
                cursor: pointer;
                box-shadow: 0 4px 12px rgba(59, 130, 246, 0.4);
                transition: all 0.2s ease;
            }
            
            .mobile-fab:hover {
                transform: scale(1.1);
                box-shadow: 0 6px 16px rgba(59, 130, 246, 0.5);
            }
            
            .mobile-controls {
                display: flex;
                gap: 8px;
                align-items: center;
            }
            
            .mobile-control-btn {
                width: 36px;
                height: 36px;
                background: #f3f4f6;
                border: 2px solid #e5e7eb;
                border-radius: 8px;
                display: flex;
                align-items: center;
                justify-content: center;
                font-size: 16px;
                cursor: pointer;
                transition: all 0.2s ease;
            }
            
            .mobile-control-btn:hover {
                background: #e5e7eb;
                transform: scale(1.05);
            }
            
            .mobile-control-btn.increase {
                background: #dcfce7;
                border-color: #22c55e;
                color: #16a34a;
            }
            
            .mobile-control-btn.decrease {
                background: #fee2e2;
                border-color: #ef4444;
                color: #dc2626;
            }
        }
        
        /* Desktop styles */
        @media (min-width: 769px) {
            .mobile-only {
                display: none;
            }
        }
        
        /* Mobile only */
        @media (max-width: 768px) {
            .desktop-only {
                display: none;
            }
            
            .mobile-only {
                display: block;
            }
        }
        
        /* Animations */
        .fade-in {
            animation: fadeIn 0.3s ease-in-out;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .pulse {
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }
        
        /* Custom scrollbar for mobile */
        @media (max-width: 768px) {
            ::-webkit-scrollbar {
                width: 4px;
            }
            
            ::-webkit-scrollbar-track {
                background: #f1f1f1;
            }
            
            ::-webkit-scrollbar-thumb {
                background: #c1c1c1;
                border-radius: 2px;
            }
            
            ::-webkit-scrollbar-thumb:hover {
                background: #a1a1a1;
            }
        }
    </style>
</head>
<body class="bg-gray-100 min-h-screen">
    <!-- Mobile Header -->
    <div class="mobile-only fixed top-0 left-0 w-full bg-white shadow-lg z-50">
        <div class="flex items-center justify-between p-4">
            <h1 class="text-xl font-bold text-gray-800">💰 รายรับ-รายจ่าย</h1>
            <button id="mobile-menu-btn" class="text-gray-600 hover:text-gray-800 focus:outline-none">
                <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path>
                </svg>
            </button>
        </div>
        
        <!-- Mobile Menu -->
        <div id="mobile-menu" class="hidden bg-white border-t">
            <nav class="py-2">
                <a href="#" class="block px-4 py-3 text-gray-700 hover:bg-gray-100 border-b">📅 บันทึกโอที</a>
                <a href="#" class="block px-4 py-3 bg-green-100 text-green-700 font-medium border-b">💰 รายรับ/รายจ่าย</a>
                <a href="#" class="block px-4 py-3 text-gray-700 hover:bg-gray-100 border-b">🎉 วันหยุด</a>
                <a href="#" class="block px-4 py-3 text-gray-700 hover:bg-gray-100 border-b">📊 นำเข้า CSV</a>
                <a href="#" class="block px-4 py-3 text-gray-700 hover:bg-gray-100 border-b">⚙️ ตั้งค่า</a>
                <a href="#" class="block px-4 py-3 text-red-600 hover:bg-red-50">🚪 ออกจากระบบ</a>
            </nav>
        </div>
    </div>

    <!-- Desktop Sidebar -->
    <div class="desktop-only fixed top-0 left-0 w-64 h-full bg-white shadow-lg z-40">
        <div class="p-6">
            <h1 class="text-2xl font-bold text-gray-800 mb-8">📊 ระบบจัดการ</h1>
            <nav class="space-y-2">
                <a href="#" class="block px-4 py-3 text-gray-700 hover:bg-gray-100 rounded-lg">📅 บันทึกโอที</a>
                <a href="#" class="block px-4 py-3 bg-green-100 text-green-700 font-medium rounded-lg">💰 รายรับ/รายจ่าย</a>
                <a href="#" class="block px-4 py-3 text-gray-700 hover:bg-gray-100 rounded-lg">🎉 วันหยุด</a>
                <a href="#" class="block px-4 py-3 text-gray-700 hover:bg-gray-100 rounded-lg">📊 นำเข้า CSV</a>
                <a href="#" class="block px-4 py-3 text-gray-700 hover:bg-gray-100 rounded-lg">⚙️ ตั้งค่า</a>
            </nav>
        </div>
    </div>

    <!-- Main Content -->
    <div class="lg:ml-64 mobile-container lg:pt-6 lg:p-6">
        <!-- Mobile Summary Cards -->
        <div class="mobile-only mobile-summary-grid">
            <div class="mobile-summary-card">
                <div class="mobile-summary-icon">💰</div>
                <div class="mobile-summary-amount text-green-600">15,000.00</div>
                <div class="mobile-summary-label">รายรับ</div>
            </div>
            <div class="mobile-summary-card">
                <div class="mobile-summary-icon">💸</div>
                <div class="mobile-summary-amount text-red-600">8,500.00</div>
                <div class="mobile-summary-label">รายจ่าย</div>
            </div>
            <div class="mobile-summary-card">
                <div class="mobile-summary-icon">📊</div>
                <div class="mobile-summary-amount text-blue-600">6,500.00</div>
                <div class="mobile-summary-label">คงเหลือ</div>
            </div>
            <div class="mobile-summary-card">
                <div class="mobile-summary-icon">📝</div>
                <div class="mobile-summary-amount text-gray-600">24</div>
                <div class="mobile-summary-label">รายการ</div>
            </div>
        </div>

        <!-- Add Transaction Form -->
        <div class="mobile-card fade-in">
            <h2 class="text-lg font-bold text-gray-800 mb-4 flex items-center gap-2">
                <span>➕</span>
                <span>เพิ่มรายการใหม่</span>
            </h2>
            
            <form id="transaction-form" class="space-y-4">
                <!-- Date -->
                <div class="mobile-form-field">
                    <label class="mobile-label">
                        <span>📅</span>
                        <span>วันที่</span>
                    </label>
                    <input type="date" id="date" class="mobile-input" required>
                </div>

                <!-- Transaction Type -->
                <div class="mobile-form-field">
                    <label class="mobile-label">
                        <span>📊</span>
                        <span>ประเภทรายการ</span>
                    </label>
                    <select id="transaction-type" class="mobile-select" required>
                        <option value="">-- เลือกประเภทรายการ --</option>
                        <option value="income">💰 รายรับ</option>
                        <option value="expense">💸 รายจ่าย</option>
                    </select>
                </div>

                <!-- Main Category -->
                <div class="mobile-form-field">
                    <label class="mobile-label">
                        <span>🏷️</span>
                        <span>ประเภทหลัก</span>
                    </label>
                    <div class="flex gap-2">
                        <select id="main-category" class="mobile-select" required>
                            <option value="">-- เลือกประเภทหลัก --</option>
                        </select>
                        <button type="button" id="add-main-category-btn" class="mobile-button-secondary" style="width: 48px; min-width: 48px;">➕</button>
                    </div>
                </div>

                <!-- Sub Category -->
                <div class="mobile-form-field">
                    <label class="mobile-label">
                        <span>📂</span>
                        <span>ประเภทย่อย</span>
                    </label>
                    <div class="flex gap-2">
                        <select id="sub-category" class="mobile-select" required>
                            <option value="">-- เลือกประเภทย่อย --</option>
                        </select>
                        <button type="button" id="add-sub-category-btn" class="mobile-button-secondary" style="width: 48px; min-width: 48px;">➕</button>
                    </div>
                </div>

                <!-- Income Amount (แสดงเฉพาะรายรับ) -->
                <div id="income-section" class="mobile-form-field hidden">
                    <label class="mobile-label">
                        <span>💰</span>
                        <span>จำนวนเงิน (บาท)</span>
                    </label>
                    <input type="number" id="income-amount" class="mobile-input" step="0.01" min="0" placeholder="0.00">
                </div>

                <!-- Items Section (แสดงเฉพาะรายจ่าย) -->
                <div id="items-section" class="mobile-form-field hidden">
                    <label class="mobile-label">
                        <span>🛒</span>
                        <span>รายการสินค้า</span>
                    </label>
                    
                    <!-- Selected Items -->
                    <div id="selected-items-container" class="mb-4">
                        <div id="selected-items"></div>
                    </div>

                    <!-- Add Item Form -->
                    <div class="bg-gray-50 rounded-12 p-4 border-2 border-dashed border-gray-300">
                        <h4 class="font-semibold text-gray-800 mb-3 flex items-center gap-2">
                            <span>➕</span>
                            <span>เพิ่มรายการใหม่</span>
                        </h4>
                        
                        <div class="space-y-3">
                            <!-- Item Name & Emoji -->
                            <div>
                                <label class="mobile-label">
                                    <span id="selected-emoji">😊</span>
                                    <span>ชื่อสินค้า</span>
                                </label>
                                <div class="flex gap-2">
                                    <input type="text" id="item-name" class="mobile-input" placeholder="ชื่อสินค้า...">
                                    <button type="button" id="emoji-picker-btn" class="mobile-button-secondary" style="width: 48px; min-width: 48px;">
                                        <span id="emoji-display">😊</span>
                                    </button>
                                </div>
                            </div>

                            <!-- Price & Quantity -->
                            <div class="grid grid-cols-2 gap-3">
                                <div>
                                    <label class="mobile-label">
                                        <span>💰</span>
                                        <span>ราคา</span>
                                    </label>
                                    <input type="number" id="item-price" class="mobile-input" step="0.01" min="0" placeholder="0.00">
                                </div>
                                <div>
                                    <label class="mobile-label">
                                        <span>📊</span>
                                        <span>จำนวน</span>
                                    </label>
                                    <input type="number" id="item-quantity" class="mobile-input" min="1" value="1">
                                </div>
                            </div>

                            <!-- Tag Selection -->
                            <div>
                                <label class="mobile-label">
                                    <span>🏷️</span>
                                    <span>แท็ก</span>
                                </label>
                                <select id="item-tag" class="mobile-select">
                                    <option value="">เลือกแท็ก</option>
                                    <option value="อาหาร">🍽️ อาหาร</option>
                                    <option value="เครื่องดื่ม">🥤 เครื่องดื่ม</option>
                                    <option value="ของใช้">🛍️ ของใช้</option>
                                    <option value="ยา">💊 ยา</option>
                                    <option value="ขนม">🍪 ขนม</option>
                                    <option value="ผลไม้">🍎 ผลไม้</option>
                                    <option value="ผัก">🥬 ผัก</option>
                                    <option value="เนื้อสัตว์">🥩 เนื้อสัตว์</option>
                                    <option value="นม">🥛 นม</option>
                                    <option value="ขนมปัง">🍞 ขนมปัง</option>
                                </select>
                            </div>

                            <!-- Emoji Picker -->
                            <div id="emoji-picker" class="hidden">
                                <div class="mobile-emoji-picker" id="emoji-grid"></div>
                                <button type="button" onclick="closeEmojiPicker()" class="mobile-button-secondary mt-2">ปิด</button>
                            </div>

                            <!-- Add Item Button -->
                            <button type="button" onclick="addItem()" class="mobile-button mobile-button-success">
                                <span>➕</span>
                                <span>เพิ่มรายการ</span>
                            </button>
                        </div>
                    </div>

                    <!-- Items Summary -->
                    <div class="bg-blue-50 rounded-12 p-4 mt-4 border border-blue-200">
                        <div class="flex justify-between items-center">
                            <span class="font-semibold text-blue-800">รวมทั้งหมด:</span>
                            <span id="total-items" class="text-blue-600">0 รายการ</span>
                        </div>
                        <div class="flex justify-between items-center mt-1">
                            <span class="font-semibold text-blue-800">ยอดรวม:</span>
                            <span id="total-amount" class="text-lg font-bold text-blue-600">0.00 บาท</span>
                        </div>
                    </div>
                </div>

                <!-- Vendor (แสดงเฉพาะรายจ่าย) -->
                <div id="vendor-section" class="mobile-form-field hidden">
                    <label class="mobile-label">
                        <span>🏪</span>
                        <span>ร้านค้า</span>
                    </label>
                    <div class="flex gap-2">
                        <select id="vendor" class="mobile-select">
                            <option value="">-- เลือกร้านค้า --</option>
                            <option value="ร้านยายจ่อย">ร้านยายจ่อย</option>
                            <option value="ร้านผัก">ร้านผัก</option>
                            <option value="เจ้นัน">เจ้นัน</option>
                            <option value="7-Eleven">7-Eleven</option>
                            <option value="เงินสด">เงินสด</option>
                        </select>
                        <button type="button" id="add-vendor-btn" class="mobile-button-secondary" style="width: 48px; min-width: 48px;">➕</button>
                    </div>
                </div>

                <!-- Description -->
                <div class="mobile-form-field">
                    <label class="mobile-label">
                        <span>📝</span>
                        <span>รายละเอียด</span>
                    </label>
                    <input type="text" id="description" class="mobile-input" placeholder="รายละเอียดเพิ่มเติม...">
                </div>

                <!-- Submit Button -->
                <button type="submit" class="mobile-button mobile-button-primary">
                    <span>💾</span>
                    <span>บันทึกรายการ</span>
                </button>
            </form>
        </div>

        <!-- Month Selection -->
        <div class="mobile-card">
            <h2 class="text-lg font-bold text-gray-800 mb-4 flex items-center gap-2">
                <span>📅</span>
                <span>เลือกเดือน</span>
            </h2>
            
            <div class="mobile-form-field">
                <select id="month-select" class="mobile-select" onchange="changeMonth(this.value)">
                    <option value="2025-01">มกราคม 2025</option>
                    <option value="2024-12">ธันวาคม 2024</option>
                    <option value="2024-11">พฤศจิกายน 2024</option>
                </select>
            </div>
            
            <!-- Export Buttons -->
            <div class="grid grid-cols-2 gap-2 mt-4">
                <button onclick="exportData('all')" class="mobile-button-secondary text-sm">📄 ส่งออกทั้งหมด</button>
                <button onclick="exportData('income')" class="mobile-button-secondary text-sm">💰 ส่งออกรายรับ</button>
                <button onclick="exportData('expense')" class="mobile-button-secondary text-sm">💸 ส่งออกรายจ่าย</button>
                <button onclick="showMonthlySummary()" class="mobile-button-secondary text-sm">📋 สรุปเดือน</button>
            </div>
        </div>

        <!-- Records List -->
        <div class="mobile-card">
            <h2 class="text-lg font-bold text-gray-800 mb-4 flex items-center gap-2">
                <span>📊</span>
                <span>รายการทั้งหมด</span>
            </h2>
            
            <div id="records-container">
                <!-- Sample Records -->
                <div class="mobile-record-card income fade-in">
                    <div class="mobile-record-header">
                        <div class="mobile-record-date">📅 2025-01-20</div>
                        <div class="mobile-record-amount income">💰 15,000.00</div>
                    </div>
                    <div class="mobile-record-description">เงินเดือนประจำ</div>
                    <div class="mobile-record-meta">
                        <div class="mobile-record-meta-item">🏷️ เงินเดือน</div>
                        <div class="mobile-record-meta-item">📂 เงินเดือนประจำ</div>
                    </div>
                    <div class="mobile-record-actions">
                        <button class="mobile-record-btn mobile-record-btn-edit">✏️ แก้ไข</button>
                        <button class="mobile-record-btn mobile-record-btn-delete" onclick="return confirm('ต้องการลบรายการนี้หรือไม่?')">🗑️ ลบ</button>
                    </div>
                </div>

                <div class="mobile-record-card expense fade-in">
                    <div class="mobile-record-header">
                        <div class="mobile-record-date">📅 2025-01-19</div>
                        <div class="mobile-record-amount expense">💸 350.00</div>
                    </div>
                    <div class="mobile-record-description">ข้าวผัด, น้ำส้ม, ไข่เจียว</div>
                    <div class="mobile-record-meta">
                        <div class="mobile-record-meta-item">🏪 ร้านยายจ่อย</div>
                        <div class="mobile-record-meta-item">🏷️ อาหาร</div>
                        <div class="mobile-record-meta-item">📂 อาหารกลางวัน</div>
                        <div class="mobile-record-meta-item">📊 3 รายการ</div>
                    </div>
                    <div class="mobile-record-actions">
                        <button class="mobile-record-btn mobile-record-btn-edit">✏️ แก้ไข</button>
                        <button class="mobile-record-btn mobile-record-btn-delete" onclick="return confirm('ต้องการลบรายการนี้หรือไม่?')">🗑️ ลบ</button>
                    </div>
                </div>

                <div class="mobile-record-card expense fade-in">
                    <div class="mobile-record-header">
                        <div class="mobile-record-date">📅 2025-01-18</div>
                        <div class="mobile-record-amount expense">💸 150.00</div>
                    </div>
                    <div class="mobile-record-description">น้ำดื่ม, ขนมปัง</div>
                    <div class="mobile-record-meta">
                        <div class="mobile-record-meta-item">🏪 7-Eleven</div>
                        <div class="mobile-record-meta-item">🏷️ ของใช้</div>
                        <div class="mobile-record-meta-item">📂 ของใช้ทั่วไป</div>
                        <div class="mobile-record-meta-item">📊 2 รายการ</div>
                    </div>
                    <div class="mobile-record-actions">
                        <button class="mobile-record-btn mobile-record-btn-edit">✏️ แก้ไข</button>
                        <button class="mobile-record-btn mobile-record-btn-delete" onclick="return confirm('ต้องการลบรายการนี้หรือไม่?')">🗑️ ลบ</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Desktop Table (Hidden on Mobile) -->
        <div class="desktop-only bg-white rounded-lg shadow-md overflow-hidden">
            <div class="p-6 border-b">
                <h2 class="text-xl font-semibold text-gray-800">📊 รายการทั้งหมด</h2>
            </div>
            <div class="overflow-x-auto">
                <table class="w-full">
                    <thead class="bg-gray-50">
                        <tr>
                            <th class="px-6 py-3 text-left text-sm font-semibold text-gray-700">วันที่</th>
                            <th class="px-6 py-3 text-left text-sm font-semibold text-gray-700">รายละเอียด</th>
                            <th class="px-6 py-3 text-left text-sm font-semibold text-gray-700">จำนวน</th>
                            <th class="px-6 py-3 text-left text-sm font-semibold text-gray-700">ประเภท</th>
                            <th class="px-6 py-3 text-left text-sm font-semibold text-gray-700">จัดการ</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr class="border-b hover:bg-gray-50">
                            <td class="px-6 py-4">2025-01-20</td>
                            <td class="px-6 py-4">เงินเดือนประจำ</td>
                            <td class="px-6 py-4 text-green-600 font-bold">15,000.00</td>
                            <td class="px-6 py-4">
                                <span class="px-3 py-1 bg-green-100 text-green-700 rounded-full text-sm">รายรับ</span>
                            </td>
                            <td class="px-6 py-4">
                                <div class="flex gap-2">
                                    <button class="bg-blue-500 text-white px-3 py-1 rounded text-sm">แก้ไข</button>
                                    <button class="bg-red-500 text-white px-3 py-1 rounded text-sm">ลบ</button>
                                </div>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <!-- Floating Action Button (Mobile Only) -->
    <div class="mobile-only mobile-floating-menu">
        <button class="mobile-fab" onclick="scrollToTop()">
            ⬆️
        </button>
    </div>

    <script>
        // Global Variables
        let selectedItems = [];
        let itemCounter = 0;
        let currentEmoji = '😊';
        
        // Category Data
        const categoryData = {
            income: {
                'เงินเดือน': ['เงินเดือนประจำ', 'โบนัส', 'ค่าล่วงเวลา', 'ค่าคอมมิชชั่น'],
                'รายได้เสริม': ['งานฟรีแลนซ์', 'ขายของออนไลน์', 'รับจ้างทั่วไป'],
                'เงินออม': ['ดอกเบี้ยเงินฝาก', 'เงินปันผล', 'เงินคืนภาษี'],
                'อื่นๆ': ['ของขวัญ', 'เงินกู้', 'รายได้อื่นๆ']
            },
            expense: {
                'อาหาร': ['อาหารเช้า', 'อาหารกลางวัน', 'อาหารเย็น', 'ของว่าง', 'เครื่องดื่ม'],
                'การเดินทาง': ['รถเมล์', 'รถไฟฟ้า', 'แท็กซี่', 'น้ำมันรถ', 'ค่าจอดรถ'],
                'ที่อยู่อาศัย': ['ค่าเช่า', 'ค่าน้ำ', 'ค่าไฟ', 'ค่าแก๊ส', 'ค่าอินเทอร์เน็ต'],
                'สุขภาพ': ['ยา', 'ตรวจสุขภาพ', 'ฟิตเนส', 'อาหารเสริม'],
                'การศึกษา': ['ค่าเล่าเรียน', 'หนังสือ', 'อุปกรณ์การเรียน', 'คอร์สออนไลน์'],
                'ความบันเทิง': ['ดูหนัง', 'ฟังเพลง', 'เกม', 'ท่องเที่ยว'],
                'เสื้อผ้า': ['เสื้อ', 'กางเกง', 'รองเท้า', 'กระเป๋า', 'เครื่องประดับ'],
                'ของใช้': ['เครื่องสำอาง', 'ของใช้ในบ้าน', 'อุปกรณ์อิเล็กทรอนิกส์'],
                'อื่นๆ': ['ค่าธรรมเนียม', 'ของขวัญ', 'บริจาค', 'รายจ่ายอื่นๆ']
            }
        };
        
        // Emoji Data by Tag
        const emojiData = {
            'อาหาร': ['🍽️', '🍜', '🍕', '🍔', '🍟', '🌮', '🌯', '🥪', '🍱', '🍛', '🍝', '🍲', '🥗', '🍣', '🍤'],
            'เครื่องดื่ม': ['🥤', '☕', '🧃', '🍺', '🍷', '🥛', '🧋', '🍹', '💧', '🥃', '🍵', '🧊', '🥤', '🍶', '🧉'],
            'ของใช้': ['🛍️', '🧴', '🧻', '🧽', '👕', '👖', '👟', '👜', '💄', '🪞', '🧼', '🪥', '🪒', '💊', '🔋'],
            'ยา': ['💊', '🏥', '🩺', '🩹', '🩻', '💉', '🩸', '🧬', '🔬', '📋', '🌡️', '⚕️', '🏥', '💉', '🩹'],
            'ขนม': ['🍪', '🍩', '🍰', '🧁', '🍦', '🍨', '🍭', '🍫', '🍬', '🍡', '🥧', '🎂', '🧁', '🍮', '🍯'],
            'ผลไม้': ['🍎', '🍌', '🍊', '🍇', '🍓', '🍑', '🥭', '🍍', '🥥', '🥝', '🫐', '🍈', '🍉', '🍋', '🫒'],
            'ผัก': ['🥬', '🥕', '🥦', '🥒', '🍅', '🌽', '🥑', '🧅', '🧄', '🌶️', '🥔', '🍆', '🥬', '🫑', '🥒'],
            'เนื้อสัตว์': ['🥩', '🍗', '🍖', '🥓', '🐟', '🦐', '🦑', '🦞', '🦀', '🐔', '🐷', '🐄', '🐟', '🍤', '🦆'],
            'นม': ['🥛', '🧀', '🍦', '🍨', '🧈', '🍼', '🥛', '🧀', '🥛', '🧈', '🍦', '🍨', '🥛', '🧀', '🍼'],
            'ขนมปัง': ['🍞', '🥖', '🥨', '🥯', '🥐', '🥪', '🥞', '🧇', '🍞', '🥖', '🥨', '🥯', '🥐', '🥪', '🧇']
        };
        
        // Default emojis for tags
        const defaultTagEmojis = {
            'อาหาร': '🍽️',
            'เครื่องดื่ม': '🥤',
            'ของใช้': '🛍️',
            'ยา': '💊',
            'ขนม': '🍪',
            'ผลไม้': '🍎',
            'ผัก': '🥬',
            'เนื้อสัตว์': '🥩',
            'นม': '🥛',
            'ขนมปัง': '🍞'
        };

        // DOM Elements
        const mobileMenuBtn = document.getElementById('mobile-menu-btn');
        const mobileMenu = document.getElementById('mobile-menu');
        const transactionType = document.getElementById('transaction-type');
        const mainCategory = document.getElementById('main-category');
        const subCategory = document.getElementById('sub-category');
        const incomeSection = document.getElementById('income-section');
        const itemsSection = document.getElementById('items-section');
        const vendorSection = document.getElementById('vendor-section');

        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            // Set today's date
            const today = new Date().toISOString().split('T')[0];
            document.getElementById('date').value = today;
            
            // Setup event listeners
            setupEventListeners();
            
            // Initialize emoji picker
            setupEmojiPicker();
        });

        function setupEventListeners() {
            // Mobile menu toggle
            mobileMenuBtn.addEventListener('click', () => {
                mobileMenu.classList.toggle('hidden');
            });

            // Close mobile menu when clicking outside
            document.addEventListener('click', (e) => {
                if (!mobileMenuBtn.contains(e.target) && !mobileMenu.contains(e.target)) {
                    mobileMenu.classList.add('hidden');
                }
            });

            // Transaction type change
            transactionType.addEventListener('change', handleTransactionTypeChange);
            
            // Category changes
            mainCategory.addEventListener('change', handleMainCategoryChange);
            subCategory.addEventListener('change', handleSubCategoryChange);
            
            // Tag change for emoji update
            document.getElementById('item-tag').addEventListener('change', handleTagChange);
            
            // Emoji picker button
            document.getElementById('emoji-picker-btn').addEventListener('click', showEmojiPicker);
            
            // Form submission
            document.getElementById('transaction-form').addEventListener('submit', handleFormSubmit);
            
            // Item form enter key handlers
            setupItemFormHandlers();
        }

        function setupItemFormHandlers() {
            const itemName = document.getElementById('item-name');
            const itemPrice = document.getElementById('item-price');
            const itemQuantity = document.getElementById('item-quantity');
            
            itemName.addEventListener('keypress', (e) => {
                if (e.key === 'Enter') {
                    e.preventDefault();
                    itemPrice.focus();
                }
            });
            
            itemPrice.addEventListener('keypress', (e) => {
                if (e.key === 'Enter') {
                    e.preventDefault();
                    itemQuantity.focus();
                }
            });
            
            itemQuantity.addEventListener('keypress', (e) => {
                if (e.key === 'Enter') {
                    e.preventDefault();
                    addItem();
                }
            });
        }

        function handleTransactionTypeChange() {
            const type = transactionType.value;
            
            // Clear categories
            mainCategory.innerHTML = '<option value="">-- เลือกประเภทหลัก --</option>';
            subCategory.innerHTML = '<option value="">-- เลือกประเภทย่อย --</option>';
            
            // Hide all sections first
            incomeSection.classList.add('hidden');
            itemsSection.classList.add('hidden');
            vendorSection.classList.add('hidden');
            
            if (type === 'income') {
                incomeSection.classList.remove('hidden');
                populateCategories('income');
            } else if (type === 'expense') {
                itemsSection.classList.remove('hidden');
                vendorSection.classList.remove('hidden');
                populateCategories('expense');
            }
        }

        function populateCategories(type) {
            const categories = categoryData[type];
            
            Object.keys(categories).forEach(category => {
                const option = document.createElement('option');
                option.value = category;
                option.textContent = category;
                mainCategory.appendChild(option);
            });
        }

        function handleMainCategoryChange() {
            const type = transactionType.value;
            const main = mainCategory.value;
            
            subCategory.innerHTML = '<option value="">-- เลือกประเภทย่อย --</option>';
            
            if (type && main && categoryData[type][main]) {
                categoryData[type][main].forEach(sub => {
                    const option = document.createElement('option');
                    option.value = sub;
                    option.textContent = sub;
                    subCategory.appendChild(option);
                });
            }
        }

        function handleSubCategoryChange() {
            // Auto-generate description for income
            if (transactionType.value === 'income') {
                const main = mainCategory.value;
                const sub = subCategory.value;
                if (main && sub) {
                    document.getElementById('description').value = `${main}: ${sub}`;
                }
            }
        }

        function handleTagChange() {
            const tag = document.getElementById('item-tag').value;
            if (tag && defaultTagEmojis[tag]) {
                currentEmoji = defaultTagEmojis[tag];
                updateEmojiDisplay();
            }
        }

        function setupEmojiPicker() {
            // Initialize with default emoji
            updateEmojiDisplay();
        }

        function showEmojiPicker() {
            const picker = document.getElementById('emoji-picker');
            const grid = document.getElementById('emoji-grid');
            const selectedTag = document.getElementById('item-tag').value;
            
            // Clear previous emojis
            grid.innerHTML = '';
            
            let emojisToShow = [];
            
            if (selectedTag && emojiData[selectedTag]) {
                emojisToShow = emojiData[selectedTag];
            } else {
                // Show all emojis
                emojisToShow = [
                    '😀', '😃', '😄', '😁', '😆', '😅', '😂', '🤣', '😊', '😇',
                    '🙂', '🙃', '😉', '😌', '😍', '🥰', '😘', '😗', '😙', '😚',
                    '😋', '😛', '😝', '😜', '🤪', '🤨', '🧐', '🤓', '😎', '🤩',
                    '🥳', '😏', '😒', '😞', '😔', '😟', '😕', '🙁', '☹️', '😣',
                    '🍽️', '🍜', '🍕', '🍔', '🍟', '🌮', '🌯', '🥪', '🍱', '🍛',
                    '🥤', '☕', '🧃', '🍺', '🍷', '🥛', '🧋', '🍹', '💧', '🥃',
                    '🛍️', '🧴', '🧻', '🧽', '👕', '👖', '👟', '👜', '💄', '🪞',
                    '💊', '🏥', '🩺', '🩹', '🩻', '💉', '🩸', '🧬', '🔬', '📋',
                    '🍪', '🍩', '🍰', '🧁', '🍦', '🍨', '🍭', '🍫', '🍬', '🍡',
                    '🍎', '🍌', '🍊', '🍇', '🍓', '🍑', '🥭', '🍍', '🥥', '🥝',
                    '🥬', '🥕', '🥦', '🥒', '🍅', '🌽', '🥑', '🧅', '🧄', '🌶️',
                    '🥩', '🍗', '🍖', '🥓', '🐟', '🦐', '🦑', '🦞', '🦀', '🐔',
                    '🥛', '🧀', '🍦', '🍨', '🧈', '🍼', '🥛', '🧀', '🥛', '🧈',
                    '🍞', '🥖', '🥨', '🥯', '🥐', '🥪', '🥞', '🧇', '🍞', '🥖'
                ];
            }
            
            emojisToShow.forEach(emoji => {
                const button = document.createElement('button');
                button.className = 'mobile-emoji-btn';
                button.textContent = emoji;
                button.type = 'button';
                button.onclick = () => selectEmoji(emoji);
                grid.appendChild(button);
            });
            
            picker.classList.remove('hidden');
        }

        function selectEmoji(emoji) {
            currentEmoji = emoji;
            updateEmojiDisplay();
            closeEmojiPicker();
        }

        function updateEmojiDisplay() {
            document.getElementById('emoji-display').textContent = currentEmoji;
            document.getElementById('selected-emoji').textContent = currentEmoji;
        }

        function closeEmojiPicker() {
            document.getElementById('emoji-picker').classList.add('hidden');
        }

        function addItem() {
            const name = document.getElementById('item-name').value.trim();
            const price = parseFloat(document.getElementById('item-price').value) || 0;
            const quantity = parseInt(document.getElementById('item-quantity').value) || 1;
            const tag = document.getElementById('item-tag').value;
            
            if (!name) {
                alert('กรุณากรอกชื่อสินค้า');
                document.getElementById('item-name').focus();
                return;
            }
            
            if (price <= 0) {
                alert('กรุณากรอกราคาที่มากกว่า 0');
                document.getElementById('item-price').focus();
                return;
            }
            
            const item = {
                id: ++itemCounter,
                name: name,
                emoji: currentEmoji,
                tag: tag,
                price: price,
                quantity: quantity,
                total: price * quantity
            };
            
            selectedItems.push(item);
            updateItemsDisplay();
            clearItemForm();
            
            // Show success animation
            const addBtn = document.querySelector('button[onclick="addItem()"]');
            addBtn.style.transform = 'scale(1.05)';
            addBtn.innerHTML = '<span>✅</span><span>เพิ่มแล้ว</span>';
            
            setTimeout(() => {
                addBtn.style.transform = 'scale(1)';
                addBtn.innerHTML = '<span>➕</span><span>เพิ่มรายการ</span>';
                document.getElementById('item-name').focus();
            }, 1000);
        }

        function clearItemForm() {
            document.getElementById('item-name').value = '';
            document.getElementById('item-price').value = '';
            document.getElementById('item-quantity').value = '1';
            document.getElementById('item-tag').value = '';
            currentEmoji = '😊';
            updateEmojiDisplay();
        }

        function updateItemsDisplay() {
            const container = document.getElementById('selected-items');
            const totalItems = document.getElementById('total-items');
            const totalAmount = document.getElementById('total-amount');
            
            if (selectedItems.length === 0) {
                container.innerHTML = '<div class="text-center text-gray-500 py-4">ยังไม่มีรายการสินค้า</div>';
                totalItems.textContent = '0 รายการ';
                totalAmount.textContent = '0.00 บาท';
                return;
            }
            
            let total = 0;
            let html = '<div class="space-y-3">';
            
            selectedItems.forEach((item, index) => {
                total += item.total;
                html += `
                    <div class="mobile-item-card fade-in">
                        <div class="mobile-item-header">
                            <div class="flex items-center">
                                <div class="mobile-item-number">${index + 1}</div>
                                <span class="text-xl mr-2">${item.emoji}</span>
                                <span class="font-medium">${item.name}</span>
                            </div>
                            <button onclick="removeItem(${item.id})" class="text-red-500 hover:text-red-700 p-2">
                                🗑️
                            </button>
                        </div>
                        
                        <div class="grid grid-cols-2 gap-3 mb-3">
                            <div>
                                <label class="mobile-label">💰 ราคา</label>
                                <div class="mobile-controls">
                                    <button onclick="decreasePrice(${item.id})" class="mobile-control-btn decrease">−</button>
                                    <input type="number" value="${item.price}" step="0.01" min="0"
                                           onchange="updateItemPrice(${item.id}, this.value)"
                                           class="mobile-input text-center" style="padding: 8px;">
                                    <button onclick="increasePrice(${item.id})" class="mobile-control-btn increase">+</button>
                                </div>
                            </div>
                            <div>
                                <label class="mobile-label">📊 จำนวน</label>
                                <div class="mobile-controls">
                                    <button onclick="decreaseQuantity(${item.id})" class="mobile-control-btn decrease">−</button>
                                    <input type="number" value="${item.quantity}" min="1"
                                           onchange="updateItemQuantity(${item.id}, this.value)"
                                           class="mobile-input text-center" style="padding: 8px;">
                                    <button onclick="increaseQuantity(${item.id})" class="mobile-control-btn increase">+</button>
                                </div>
                            </div>
                        </div>
                        
                        ${item.tag ? `<div class="text-sm text-gray-600 mb-2">🏷️ ${item.tag}</div>` : ''}
                        
                        <div class="flex justify-between items-center pt-2 border-t">
                            <span class="text-sm text-gray-600">รวม:</span>
                            <span class="font-bold text-green-600">${item.total.toFixed(2)} บาท</span>
                        </div>
                    </div>
                `;
            });
            
            html += '</div>';
            container.innerHTML = html;
            totalItems.textContent = `${selectedItems.length} รายการ`;
            totalAmount.textContent = `${total.toFixed(2)} บาท`;
            
            // Update description
            updateDescription();
        }

        function updateDescription() {
            const descriptions = selectedItems.map(item => `${item.name} x${item.quantity}`);
            document.getElementById('description').value = descriptions.join(', ');
        }

        function removeItem(itemId) {
            selectedItems = selectedItems.filter(item => item.id !== itemId);
            updateItemsDisplay();
        }

        function updateItemPrice(itemId, newPrice) {
            const item = selectedItems.find(item => item.id === itemId);
            const price = parseFloat(newPrice);
            if (item && !isNaN(price) && price >= 0) {
                item.price = price;
                item.total = item.price * item.quantity;
                updateItemsDisplay();
            }
        }

        function updateItemQuantity(itemId, newQuantity) {
            const item = selectedItems.find(item => item.id === itemId);
            const quantity = parseInt(newQuantity);
            if (item && !isNaN(quantity) && quantity > 0) {
                item.quantity = quantity;
                item.total = item.price * item.quantity;
                updateItemsDisplay();
            }
        }

        function increasePrice(itemId) {
            const item = selectedItems.find(item => item.id === itemId);
            if (item) {
                item.price += 1;
                item.total = item.price * item.quantity;
                updateItemsDisplay();
            }
        }

        function decreasePrice(itemId) {
            const item = selectedItems.find(item => item.id === itemId);
            if (item && item.price > 0) {
                item.price = Math.max(0, item.price - 1);
                item.total = item.price * item.quantity;
                updateItemsDisplay();
            }
        }

        function increaseQuantity(itemId) {
            const item = selectedItems.find(item => item.id === itemId);
            if (item) {
                item.quantity += 1;
                item.total = item.price * item.quantity;
                updateItemsDisplay();
            }
        }

        function decreaseQuantity(itemId) {
            const item = selectedItems.find(item => item.id === itemId);
            if (item && item.quantity > 1) {
                item.quantity = Math.max(1, item.quantity - 1);
                item.total = item.price * item.quantity;
                updateItemsDisplay();
            }
        }

        function handleFormSubmit(e) {
            e.preventDefault();
            
            const type = transactionType.value;
            const main = mainCategory.value;
            const sub = subCategory.value;
            
            if (!type || !main || !sub) {
                alert('กรุณากรอกข้อมูลให้ครบถ้วน');
                return;
            }
            
            if (type === 'income') {
                const amount = parseFloat(document.getElementById('income-amount').value);
                if (!amount || amount <= 0) {
                    alert('กรุณากรอกจำนวนเงินสำหรับรายรับ');
                    return;
                }
                submitIncomeTransaction(amount);
            } else if (type === 'expense') {
                if (selectedItems.length === 0) {
                    alert('กรุณาเพิ่มรายการสินค้าอย่างน้อย 1 รายการ');
                    return;
                }
                const vendor = document.getElementById('vendor').value;
                if (!vendor) {
                    alert('กรุณาเลือกร้านค้า');
                    return;
                }
                submitExpenseTransaction();
            }
        }

        function submitIncomeTransaction(amount) {
            const data = {
                date: document.getElementById('date').value,
                type: 'income',
                mainCategory: mainCategory.value,
                subCategory: subCategory.value,
                amount: amount,
                description: document.getElementById('description').value
            };
            
            console.log('Submitting income:', data);
            
            // Show success message
            showSuccessMessage('บันทึกรายรับเรียบร้อยแล้ว');
            
            // Reset form
            resetForm();
        }

        function submitExpenseTransaction() {
            const total = selectedItems.reduce((sum, item) => sum + item.total, 0);
            
            const data = {
                date: document.getElementById('date').value,
                type: 'expense',
                mainCategory: mainCategory.value,
                subCategory: subCategory.value,
                vendor: document.getElementById('vendor').value,
                amount: total,
                items: selectedItems,
                description: document.getElementById('description').value
            };
            
            console.log('Submitting expense:', data);
            
            // Show success message
            showSuccessMessage(`บันทึกรายจ่าย ${selectedItems.length} รายการ เรียบร้อยแล้ว`);
            
            // Reset form
            resetForm();
        }

        function showSuccessMessage(message) {
            // Create success notification
            const notification = document.createElement('div');
            notification.className = 'fixed top-20 left-1/2 transform -translate-x-1/2 bg-green-500 text-white px-6 py-3 rounded-lg shadow-lg z-50 fade-in';
            notification.innerHTML = `
                <div class="flex items-center gap-2">
                    <span>✅</span>
                    <span>${message}</span>
                </div>
            `;
            
            document.body.appendChild(notification);
            
            // Remove notification after 3 seconds
            setTimeout(() => {
                notification.remove();
            }, 3000);
        }

        function resetForm() {
            // Reset form fields
            document.getElementById('transaction-form').reset();
            
            // Set today's date again
            const today = new Date().toISOString().split('T')[0];
            document.getElementById('date').value = today;
            
            // Clear categories
            mainCategory.innerHTML = '<option value="">-- เลือกประเภทหลัก --</option>';
            subCategory.innerHTML = '<option value="">-- เลือกประเภทย่อย --</option>';
            
            // Hide conditional sections
            incomeSection.classList.add('hidden');
            itemsSection.classList.add('hidden');
            vendorSection.classList.add('hidden');
            
            // Clear items
            selectedItems = [];
            updateItemsDisplay();
            
            // Reset emoji
            currentEmoji = '😊';
            updateEmojiDisplay();
        }

        // Utility Functions
        function changeMonth(month) {
            console.log('Changing month to:', month);
            // Here you would typically reload the page with new month data
        }

        function exportData(type) {
            console.log('Exporting data:', type);
            alert(`ส่งออกข้อมูล${type === 'all' ? 'ทั้งหมด' : type === 'income' ? 'รายรับ' : 'รายจ่าย'}`);
        }

        function showMonthlySummary() {
            const summary = `📋 สรุปประจำเดือน มกราคม 2025
            
💰 รายรับรวม: 15,000.00 บาท
💸 รายจ่ายรวม: 8,500.00 บาท
📊 ยอดคงเหลือ: 6,500.00 บาท
📝 จำนวนรายการ: 24 รายการ

✅ สถานะ: มีเงินเหลือ (กำไร)
📈 อัตราส่วนรายจ่ายต่อรายรับ: 56.7%`;
            
            alert(summary);
        }

        function scrollToTop() {
            window.scrollTo({
                top: 0,
                behavior: 'smooth'
            });
        }

        // Add custom category functions
        document.getElementById('add-main-category-btn').addEventListener('click', function() {
            const categoryName = prompt('กรุณาใส่ชื่อประเภทหลักใหม่:');
            if (categoryName && categoryName.trim()) {
                const type = transactionType.value;
                if (!type) {
                    alert('กรุณาเลือกประเภทรายการก่อน');
                    return;
                }
                
                // Add to category data
                if (!categoryData[type][categoryName]) {
                    categoryData[type][categoryName] = [];
                }
                
                // Add to select
                const option = document.createElement('option');
                option.value = categoryName;
                option.textContent = categoryName;
                mainCategory.appendChild(option);
                mainCategory.value = categoryName;
                
                alert(`เพิ่มประเภทหลัก "${categoryName}" เรียบร้อยแล้ว`);
            }
        });

        document.getElementById('add-sub-category-btn').addEventListener('click', function() {
            const main = mainCategory.value;
            if (!main) {
                alert('กรุณาเลือกประเภทหลักก่อน');
                return;
            }
            
            const categoryName = prompt('กรุณาใส่ชื่อประเภทย่อยใหม่:');
            if (categoryName && categoryName.trim()) {
                const type = transactionType.value;
                
                // Add to category data
                categoryData[type][main].push(categoryName);
                
                // Add to select
                const option = document.createElement('option');
                option.value = categoryName;
                option.textContent = categoryName;
                subCategory.appendChild(option);
                subCategory.value = categoryName;
                
                alert(`เพิ่มประเภทย่อย "${categoryName}" เรียบร้อยแล้ว`);
            }
        });

        document.getElementById('add-vendor-btn').addEventListener('click', function() {
            const vendorName = prompt('กรุณาใส่ชื่อร้านค้าใหม่:');
            if (vendorName && vendorName.trim()) {
                const vendorSelect = document.getElementById('vendor');
                
                // Check if vendor already exists
                const existingOptions = Array.from(vendorSelect.options);
                const exists = existingOptions.some(option => option.value === vendorName);
                
                if (exists) {
                    alert('ร้านค้านี้มีอยู่แล้ว');
                    return;
                }
                
                // Add new option
                const option = document.createElement('option');
                option.value = vendorName;
                option.textContent = vendorName;
                vendorSelect.appendChild(option);
                vendorSelect.value = vendorName;
                
                alert(`เพิ่มร้านค้า "${vendorName}" เรียบร้อยแล้ว`);
            }
        });

        // Responsive handling
        window.addEventListener('resize', function() {
            if (selectedItems.length > 0) {
                updateItemsDisplay();
            }
        });

        // Prevent zoom on iOS
        document.addEventListener('touchstart', function(e) {
            if (e.touches.length > 1) {
                e.preventDefault();
            }
        });

        // Smooth scroll behavior
        document.documentElement.style.scrollBehavior = 'smooth';

        // Auto-save to localStorage (optional)
        function saveFormData() {
            const formData = {
                selectedItems: selectedItems,
                transactionType: transactionType.value,
                mainCategory: mainCategory.value,
                subCategory: subCategory.value,
                date: document.getElementById('date').value
            };
            
            try {
                localStorage.setItem('incomeExpenseForm', JSON.stringify(formData));
            } catch (e) {
                console.log('localStorage not available');
            }
        }

        function loadFormData() {
            try {
                const saved = localStorage.getItem('incomeExpenseForm');
                if (saved) {
                    const formData = JSON.parse(saved);
                    
                    // Restore form state if needed
                    if (formData.selectedItems && formData.selectedItems.length > 0) {
                        const restore = confirm('พบข้อมูลฟอร์มที่บันทึกไว้ ต้องการเรียกคืนหรือไม่?');
                        if (restore) {
                            selectedItems = formData.selectedItems;
                            updateItemsDisplay();
                            
                            if (formData.transactionType) {
                                transactionType.value = formData.transactionType;
                                handleTransactionTypeChange();
                            }
                        } else {
                            localStorage.removeItem('incomeExpenseForm');
                        }
                    }
                }
            } catch (e) {
                console.log('localStorage not available');
            }
        }

        // Load saved form data on page load
        // loadFormData();

        // Save form data periodically
        setInterval(saveFormData, 30000); // Save every 30 seconds

        console.log('💰 รายรับ-รายจ่าย Mobile App Initialized');
    </script>
</body>
</html>